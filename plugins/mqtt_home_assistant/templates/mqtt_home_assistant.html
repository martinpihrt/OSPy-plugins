$def with(plugin_options, events, error_msg)

$var title: $_('MQTT Home Assistant Plugin')
$var page: plugins

<script>
    jQuery(document).ready(function(){

        jQuery("#cSubmit").click(function() {
            jQuery("#pluginForm").submit();
        });
        jQuery("button#cCancel").click(function(){
            window.location="/";
        });
    });
</script>

<style>
#errorMessage {
    color: red;
}
</style>


<div id="plugin">
    <div class="title">$_('MQTT Home Assistant Plugin')</div>
    <p><a href=$plugins.plugin_url('mqtt_home_assistant.help_page') class="button upload">$_('Help')</a></p><br/>
    <p><b>!So far only a broken test! Do not use!</b></p>
    <div id="errorMessage">${error_msg}</div>
    <form id="pluginForm" action="$plugins.plugin_url('mqtt_home_assistant.settings_page')" method="get">
        <table class="optionList">
            <tr>
                <td style="text-transform: none;">$_('Topic prefix'):</td>
                <td title=$:{json.dumps(_('MQTT base topic for system parameters and zones (Default: System name)'), ensure_ascii=False)}>
                <input type='text' name='hass_ospy_topic' value="${plugin_options['hass_ospy_topic']}">
                </td>
            </tr>
            <tr>
                <td style="text-transform: none;">$_('Name prefix'):</td>
                <td title=$:{json.dumps(_('HASS name prefix for devices and zones (Default: System name)'), ensure_ascii=False)}>
                <input type='text' name='hass_ospy_name' value="${plugin_options['hass_ospy_name']}">
                </td>
            </tr>
            <tr>
                <td style="text-transform: none;">$_('OSPy FQDN'):</td>
                <td title=$:{json.dumps(_('OSPy network name or IP address for web access from HASS (Default: auto detect)'), ensure_ascii=False)}>
                <input type='text' name='hass_ospy_fqdn' value="${plugin_options['hass_ospy_fqdn']}">
                </td>
            </tr>
            <tr>
                <td style="text-transform: none;">$_('Device name is Station name'):</td>
                <td title=$:{json.dumps(_('Use station name for HASS zone device name (Default: uncheck)'), ensure_ascii=False)}>
                <input name='hass_device_is_station_name' type='checkbox' ${" checked" if plugin_options['hass_device_is_station_name'] else ""}>
                </td>
            </tr>
            <tr>
                <td style="text-transform: none;">$_('Publish disabled zones'):</td>
                <td title=$:{json.dumps(_('MQTT publish all zones states (Default: uncheck)'), ensure_ascii=False)}>
                <input name='hass_pub_disabled' type='checkbox' ${" checked" if plugin_options['hass_pub_disabled'] else ""}>
                </td>
            </tr>
            <tr>
                <td style='text-transform: none;'>$_('Discovery UUID prefix'):</td>
                <td title=$:{json.dumps(_('Unique identifier used as prefix for MQTT Discovery by HASS'), ensure_ascii=False)}>
                ${plugin_options['hass_uuid']}
                </td>
            </tr>            
            <tr>
                <td style='text-transform: none;'>$_('Show in footer'):</td>
                <td title=$:{json.dumps(_('Show data from plugin in footer on home page'), ensure_ascii=False)}>
                <input id='use_footer' name='use_footer' type='checkbox' ${" checked" if plugin_options['use_footer'] else ""}>
                </td>
            </tr>
            <tr>
                <td style='text-transform: none;'>$_('Status'):</td>
                <td>
                <textarea style="font-family: monospace;" rows="7" cols="50" readonly>$'\n'.join(events)</textarea>
                </td>
            </tr>
        </table>
    </form>
</div>
<div id="controls">
    <button id="cSubmit" class="submit"><b>$_('Submit')</b></button>
    <button id="cCancel" class="cancel danger">$_('Cancel')</button>
</div>